<Page
    x:Class="RssReader.Views.MainPageView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:RssReader.Views"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:micro="using:Caliburn.Micro"
    xmlns:storage="using:RssReader.Storage"
    xmlns:Controls="using:RssReader.Controls"
    mc:Ignorable="d"
    Background="#FFE8BEE8">

    <Grid x:Name="Grid">
        <FlyoutBase.AttachedFlyout>
            <Flyout x:Name="ExceptionFlyout">
                <StackPanel>
                    <TextBlock x:Name="TextBlock"></TextBlock>
                    <Button x:ConnectionId='1' Content="OK"                                   ></Button>
                    <ContentControl 
                        micro:View.Model="{Binding}" 
                        micro:View.Context="MainPageViewModel">
                    </ContentControl>
                </StackPanel>
            </Flyout>
        </FlyoutBase.AttachedFlyout>
        <Button HorizontalAlignment="Left" 
                Margin="149,0,0,0"
                VerticalAlignment="Top"
                Width="73"
                micro:Message.Attach="
                [Event Click] = [Action Refresh()]" Height="77" MinHeight="40" MinWidth="40">
            <Button.Background>
                <ImageBrush ImageSource="ms-appx:///Assets/iconrefresh.png" Stretch="Uniform"/>
            </Button.Background>
        </Button>
        <Button HorizontalAlignment="Stretch" 
                Margin="250,-3,41,0" 
                VerticalAlignment="Top" 
                micro:Message.Attach=
                "[Event Click] = [Action AddNewsLine()]" 
                BorderBrush="{x:Null}" 
                Foreground="{x:Null}" RequestedTheme="Light" Height="81" RenderTransformOrigin="0.5,0.5">
            <Button.Projection>
                <PlaneProjection RotationX="0" RotationY="0" RotationZ="0"/>
            </Button.Projection>
            <Button.RenderTransform>
                <CompositeTransform Rotation="0" ScaleY="-1" ScaleX="-1"/>
            </Button.RenderTransform>
            <Button.Background>
                <ImageBrush ImageSource="ms-appx:///Assets/Plus-png.png" Stretch="Uniform"/>
            </Button.Background>
        </Button>
        <ScrollViewer Name="ScrollViewer" Margin="10,83,10,0">
            <ListView x:ConnectionId='2' Name="ListView"
                      
                      ItemsSource="{Binding News}"
                      IsItemClickEnabled="True"
                      SelectionMode="None"
                      micro:Message.Attach="                      
                      [Event ItemClick] = 
                      [Action GoToDetail($clickeditem)];
                      [Event RightTapped] = 
                      [Action PrepareToDelete($longtappeditem)]"
                      ShowsScrollingPlaceholders="True"
                      ReorderMode="Disabled"
                      IsSynchronizedWithCurrentItem="False"
                      SelectedIndex="-1"
                      IsActiveView="False" 
                                              
                                       
                                                        >
                <FlyoutBase.AttachedFlyout>
                    <Flyout x:Name="Flyout">
                        <StackPanel Background="#FFE8BEE8">
                            <Button x:ConnectionId='3' 
                                micro:Message.Attach=
                                "[Event Click] = 
                                [Action DeleteItem()]"
                                Content="Delete"                    
                                Background="#FFE8BEE8"/>
                        </StackPanel>
                    </Flyout>
                </FlyoutBase.AttachedFlyout>
                <ListView.ItemTemplate>
                    <DataTemplate>
                        <Grid Margin="0,0,0,0">
                        <StackPanel Margin="0,0,0,0" HorizontalAlignment="Stretch"  CompositeMode="MinBlend" Orientation="Horizontal">
                            <StackPanel Visibility="{Binding IsShowing}" Name="StackPanel" Orientation="Vertical">
                                <Controls:AnimationImage Name="AnimationImage" ImageUrl="/Assets/loading.gif" Width="50" Height="50"></Controls:AnimationImage>
                            </StackPanel>
                                <StackPanel Orientation="Vertical">
                                <Image x:ConnectionId='4' 
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Top"
                                    MaxHeight="80"
                                    MaxWidth="50"
                                    Stretch="Uniform"                               >
                                    <Image.Source>
                                        <BitmapImage 
                                            UriSource="{Binding ImageUrl}"
                                            DecodePixelWidth="300" DecodePixelHeight="200"/>
                                    </Image.Source>
                                </Image>
                            </StackPanel>
                            <StackPanel Margin="0,0,4000,0" Orientation="Vertical">
                                <TextBlock Text="{Binding Title}" OpticalMarginAlignment="TrimSideBearings" Margin="20,5,0,0" Foreground="Black" Style="{StaticResource BodyTextBlockStyle}" />
                                <TextBlock Text="{Binding CountUnviewedItems}" Margin="350,0,0,0" OpticalMarginAlignment="TrimSideBearings"></TextBlock>
                                <TextBlock Text="{Binding Link}" Margin="5,0,5,0" OpticalMarginAlignment="TrimSideBearings" Foreground="#FF1B1BB4" FontSize="9" Style="{StaticResource BodyTextBlockStyle}" />
                                <TextBlock Text="{Binding Description}"  OpticalMarginAlignment="TrimSideBearings" FontSize="14" Margin="0,0,100,0" Foreground="Gray" Style="{StaticResource BodyTextBlockStyle}" />
                            </StackPanel>
                        </StackPanel>
                    </Grid>
                    </DataTemplate>
                </ListView.ItemTemplate>
            </ListView>
        </ScrollViewer>
    </Grid>
</Page>

